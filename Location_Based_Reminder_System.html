<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Smart Location Reminder</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" />
<style>
  /* Simple switch knob transitions (Tailwind classes will handle most) */
  .switch-knob { transition: transform 0.15s ease; }
  .fade-enter, .fade-leave { transition: opacity 0.2s ease; }
</style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 antialiased text-gray-900">

<!-- Alarm Banner (hidden by default) -->
<div id="alarmBanner" class="hidden fixed top-0 left-0 right-0 z-50 bg-red-600 text-white p-4 animate-pulse">
  <div class="container mx-auto flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-8 h-8 flex items-center justify-center">
        <i class="ri-alarm-warning-line text-2xl"></i>
      </div>
      <div>
        <h3 class="font-bold">Location Reminder Alert!</h3>
        <p class="text-sm">You are approaching your reminder point</p>
      </div>
    </div>
    <button id="alarmDismissBtn"
      class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors">
      Dismiss
    </button>
  </div>
</div>

<!-- Navigation -->
<nav class="bg-white/80 backdrop-blur-md shadow-sm">
  <div class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <a href="index.html" class="flex items-center space-x-3 cursor-pointer">
        <img src="Travaio Travel Tech.png" alt="Travaio logo" class="w-12 h-12 bg-teal from-blue-500 to-indigo-600 rounded-xl flex items-center justify-left">
        <div>
          <h1 class="text-2xl font-bold text-teal-800" style="font-family: 'Pacifico', cursive;">Travaio</h1>
          <p class="text-xs text-gray-500">Because Peace of Mind Should Travel Too</p>
        </div>
      </a>
      <div class="flex items-center gap-4">
        <a href="user_interface.html" class="text-teal-600 hover:text-blue-600 transition-colors cursor-pointer">
          Dashboard
        </a>
        <a href="index.html" class="text-teal-600 hover:text-blue-600 transition-colors cursor-pointer">
          Home
        </a>
      </div>
    </div>
  </div>
</nav>

<div class="container mx-auto px-6 py-12">
  <!-- Header Section -->
  <div class="text-center mb-12">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">Smart Location Reminder System</h1>
    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
      Set location-based reminders that trigger as your vehicle approaches specific points. 
      More reliable than time-based alarms with GPS backup for continuous tracking.
    </p>
  </div>

  <!-- Main Content Grid -->
  <div class="grid lg:grid-cols-2 gap-12 mb-12">

    <!-- Control Panel -->
    <div class="space-y-8">
      <!-- System Status -->
      <div class="bg-white rounded-2xl shadow-sm p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">System Status</h2>
        
        <div class="grid grid-cols-2 gap-4 mb-6">
          <!-- GPS Status Card -->
          <div id="gpsStatusCard" class="p-4 rounded-xl border">
            <div class="flex items-center gap-3 mb-2">
              <div id="gpsStatusIconWrap" class="w-8 h-8 rounded-full flex items-center justify-center">
                <i id="gpsStatusIcon" class="ri-gps-line text-white text-sm"></i>
              </div>
              <span class="font-semibold text-gray-900">GPS Status</span>
            </div>
            <p id="gpsStatusText" class="text-sm">Active & Tracking</p>
          </div>

          <!-- Speed Card -->
          <div class="p-4 rounded-xl bg-blue-50 border border-blue-200">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                <i class="ri-speed-line text-white text-sm"></i>
              </div>
              <span class="font-semibold text-gray-900">Speed</span>
            </div>
            <p id="vehicleSpeedText" class="text-sm text-blue-600">65 mph</p>
          </div>
        </div>

        <!-- GPS Toggle -->
        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
          <div>
            <h3 class="font-semibold text-gray-900">GPS Tracking</h3>
            <p class="text-sm text-gray-600">Toggle GPS simulation</p>
          </div>
          <button id="gpsToggleBtn"
            class="relative inline-flex h-6 w-11 items-center rounded-full transition-colors">
            <span id="gpsToggleKnob" class="switch-knob inline-block h-4 w-4 transform rounded-full bg-white"></span>
          </button>
        </div>
      </div>

      <!-- Trip Configuration -->
      <div class="bg-white rounded-2xl shadow-sm p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Trip Configuration</h2>
        
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Current Location</label>
            <input id="currentLocationInput"
              type="text"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors text-sm"
              value="ISBT, Agra"
              readonly />
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Destination</label>
            <input id="destinationInput"
              type="text"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors text-sm"
              value="GLA University, Mathura" />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Estimated Arrival</label>
            <div class="flex items-center gap-2 px-4 py-3 bg-gray-50 rounded-xl">
              <div class="w-5 h-5 flex items-center justify-center">
                <i class="ri-time-line text-gray-600"></i>
              </div>
              <span id="etaText" class="text-sm text-gray-700">
                --
              </span>
            </div>
          </div>
        </div>
      </div>
    </div> <!-- /Control Panel -->

    <!-- Map Visualization -->
    <div class="bg-white rounded-2xl shadow-sm p-6">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Route & Reminder Points</h2>
      
      <div class="relative bg-gradient-to-br from-blue-100 to-indigo-100 rounded-xl h-96 mb-6 overflow-hidden">
        <!-- Simulated Map -->
        <div class="absolute inset-4">
          <!-- Route Line -->
          <svg class="absolute inset-0 w-full h-full">
            <path 
              d="M 50 300 Q 150 200 250 250 Q 300 200 350 150" 
              stroke="#3B82F6" 
              stroke-width="4" 
              fill="none"
              stroke-dasharray="8,4"
            ></path>
          </svg>

          <!-- Current Location -->
          <div class="absolute bottom-4 left-8 w-4 h-4 bg-green-500 rounded-full border-2 border-white shadow-lg animate-pulse">
            <div class="absolute -top-8 -left-8 text-xs font-medium text-green-700 whitespace-nowrap">
              Current Location
            </div>
          </div>

          <!-- Hard-coded demo dots -->
          <div class="absolute top-20 left-32 w-3 h-3 bg-yellow-500 rounded-full border-2 border-white shadow-lg">
            <div class="absolute -top-8 -left-12 text-xs font-medium text-yellow-700 whitespace-nowrap">
              Reminder 1
            </div>
          </div>

          <div class="absolute top-12 right-24 w-3 h-3 bg-orange-500 rounded-full border-2 border-white shadow-lg">
            <div class="absolute -top-8 -left-12 text-xs font-medium text-orange-700 whitespace-nowrap">
              Reminder 2
            </div>
          </div>

          <!-- Destination -->
          <div class="absolute top-8 right-8 w-4 h-4 bg-red-500 rounded-full border-2 border-white shadow-lg">
            <div class="absolute -top-8 -left-8 text-xs font-medium text-red-700 whitespace-nowrap">
              Destination
            </div>
          </div>
        </div>

        <!-- Map Controls (nonfunctional zoom demo) -->
        <div class="absolute top-4 right-4 flex flex-col gap-2">
          <button class="bg-white/90 hover:bg-white p-2 rounded-lg shadow-sm transition-colors">
            <div class="w-5 h-5 flex items-center justify-center">
              <i class="ri-add-line text-gray-700"></i>
            </div>
          </button>
          <button class="bg-white/90 hover:bg-white p-2 rounded-lg shadow-sm transition-colors">
            <div class="w-5 h-5 flex items-center justify-center">
              <i class="ri-subtract-line text-gray-700"></i>
            </div>
          </button>
        </div>
      </div>

      <div class="text-center text-sm text-gray-500">
        Interactive route visualization with real-time tracking
      </div>
    </div>
  </div> <!-- /Main Content Grid -->

  <!-- Reminder Points Management -->
  <div class="bg-white rounded-2xl shadow-sm p-8 mb-12">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold text-gray-900">Reminder Points</h2>
      <button id="addPointBtn"
        class="bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-semibold whitespace-nowrap">
        <span class="flex items-center gap-2">
          <span class="w-5 h-5 flex items-center justify-center">
            <i class="ri-add-line"></i>
          </span>
          Add Point
        </span>
      </button>
    </div>

    <div id="reminderPointsGrid" class="grid md:grid-cols-2 gap-4 mb-8">
      <!-- JS renders cards here -->
    </div>
  </div>

  <!-- Feature Explanation -->
  <div class="bg-white rounded-2xl shadow-sm p-8 mb-12">
    <h2 class="text-2xl font-bold text-gray-900 mb-8 text-center">How It Works</h2>
    
    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="text-center">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="ri-map-pin-add-line text-2xl text-blue-600"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">Set Reminder Points</h3>
        <p class="text-sm text-gray-600">User sets reminder locations before destination</p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="ri-navigation-line text-2xl text-green-600"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">GPS Tracking</h3>
        <p class="text-sm text-gray-600">Continuous location monitoring during travel</p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="ri-alarm-warning-line text-2xl text-yellow-600"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">Smart Alerts</h3>
        <p class="text-sm text-gray-600">Triggers alarm as vehicle approaches location</p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="ri-time-line text-2xl text-purple-600"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">Backup System</h3>
        <p class="text-sm text-gray-600">Uses speed + last location if GPS is lost</p>
      </div>
    </div>
  </div>

  <!-- Demo Controls -->
  <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-8 text-white text-center">
    <h2 class="text-2xl font-bold mb-4">Try the Demo</h2>
    <p class="text-blue-100 mb-6">Experience how the location-based alarm system works</p>
    
    <div class="flex justify-center gap-4">
      <button id="triggerAlarmBtn"
        class="bg-white/20 hover:bg-white/30 px-8 py-4 rounded-xl transition-colors font-semibold whitespace-nowrap">
        <span class="flex items-center gap-2 justify-center">
          <span class="w-5 h-5 flex items-center justify-center">
            <i class="ri-alarm-line"></i>
          </span>
          Trigger Alarm
        </span>
      </button>
      
      <button id="demoGpsToggleBtn"
        class="bg-white/20 hover:bg-white/30 px-8 py-4 rounded-xl transition-colors font-semibold whitespace-nowrap">
        <span class="flex items-center gap-2 justify-center">
          <span class="w-5 h-5 flex items-center justify-center">
            <i id="demoGpsToggleIcon" class="ri-gps-off-line"></i>
          </span>
          <span id="demoGpsToggleText">Simulate GPS Loss</span>
        </span>
      </button>
    </div>
  </div>
</div> <!-- /container -->

<script>
/* --------------------------
   State (mirrors React state)
   -------------------------- */
let isGPSActive = true;
let vehicleSpeed = 65;         // mph
let alarmTimeout = null;
let estimatedTimeLabel = '2h 15m'; // shown in UI

// Coordinates not used for map calc; demo only
let currentLocation = { lat: 40.7128, lng: -74.0060 };
let destination = { lat: 42.3601, lng: -71.0589 };

// Reminder points array (initial demo data)
let reminderPoints = [
  { id: 1, name: 'Reminder Point 1', lat: 41.5, lng: -72.5, distance: '5 kilometers before destination', active: true },
  { id: 2, name: 'Reminder Point 2', lat: 41.8, lng: -72.0, distance: '2 kilometers before destination', active: true },
];

/* --------------------------
   DOM refs
   -------------------------- */
const gpsStatusCard = document.getElementById('gpsStatusCard');
const gpsStatusIconWrap = document.getElementById('gpsStatusIconWrap');
const gpsStatusIcon = document.getElementById('gpsStatusIcon');
const gpsStatusText = document.getElementById('gpsStatusText');
const gpsToggleBtn = document.getElementById('gpsToggleBtn');
const gpsToggleKnob = document.getElementById('gpsToggleKnob');
const vehicleSpeedText = document.getElementById('vehicleSpeedText');
const etaText = document.getElementById('etaText');
const addPointBtn = document.getElementById('addPointBtn');
const reminderPointsGrid = document.getElementById('reminderPointsGrid');
const triggerAlarmBtn = document.getElementById('triggerAlarmBtn');
const demoGpsToggleBtn = document.getElementById('demoGpsToggleBtn');
const demoGpsToggleIcon = document.getElementById('demoGpsToggleIcon');
const demoGpsToggleText = document.getElementById('demoGpsToggleText');
const alarmBanner = document.getElementById('alarmBanner');
const alarmDismissBtn = document.getElementById('alarmDismissBtn');

/* --------------------------
   Render Functions
   -------------------------- */
function renderGPSStatus() {
  if (isGPSActive) {
    gpsStatusCard.className = 'p-4 rounded-xl bg-green-50 border border-green-200';
    gpsStatusIconWrap.className = 'w-8 h-8 rounded-full flex items-center justify-center bg-green-600';
    gpsStatusIcon.className = 'ri-gps-line text-white text-sm';
    gpsStatusText.className = 'text-sm text-green-600';
    gpsStatusText.textContent = 'Active & Tracking';
    gpsToggleBtn.className = 'relative inline-flex h-6 w-11 items-center rounded-full transition-colors bg-green-600';
    gpsToggleKnob.style.transform = 'translateX(1.25rem)'; // ~translate-x-6
    demoGpsToggleIcon.className = 'ri-gps-off-line';
    demoGpsToggleText.textContent = 'Simulate GPS Loss';
  } else {
    gpsStatusCard.className = 'p-4 rounded-xl bg-red-50 border border-red-200';
    gpsStatusIconWrap.className = 'w-8 h-8 rounded-full flex items-center justify-center bg-red-600';
    gpsStatusIcon.className = 'ri-gps-off-line text-white text-sm';
    gpsStatusText.className = 'text-sm text-red-600';
    gpsStatusText.textContent = 'Signal Lost - Using Backup';
    gpsToggleBtn.className = 'relative inline-flex h-6 w-11 items-center rounded-full transition-colors bg-red-600';
    gpsToggleKnob.style.transform = 'translateX(0.25rem)'; // ~translate-x-1
    demoGpsToggleIcon.className = 'ri-gps-line';
    demoGpsToggleText.textContent = 'Restore GPS';
  }
}

function renderSpeed() {
  vehicleSpeedText.textContent = vehicleSpeed + ' mph';
}

function formatETA(hoursAhead = 2.25) {
  const msAhead = hoursAhead * 60 * 60 * 1000;
  const eta = new Date(Date.now() + msAhead);
  const hhmm = eta.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
  return hhmm + ' (' + estimatedTimeLabel + ' remaining)';
}

function renderETA() {
  etaText.textContent = formatETA();
}

function renderReminderPoints() {
  reminderPointsGrid.innerHTML = '';
  reminderPoints.forEach(point => {
    const wrapper = document.createElement('div');
    wrapper.className = 'p-4 rounded-xl border-2 transition-all ' +
      (point.active ? 'bg-blue-50 border-blue-200' : 'bg-gray-50 border-gray-200');

    const inner = document.createElement('div');
    inner.className = 'flex items-center justify-between mb-3';

    const left = document.createElement('div');
    left.className = 'flex items-center gap-3';

    const pinWrap = document.createElement('div');
    pinWrap.className = 'w-8 h-8 rounded-full flex items-center justify-center ' +
      (point.active ? 'bg-blue-600' : 'bg-gray-400');

    const pinIcon = document.createElement('i');
    pinIcon.className = 'ri-map-pin-line text-white text-sm';

    pinWrap.appendChild(pinIcon);

    const textWrap = document.createElement('div');
    const title = document.createElement('h3');
    title.className = 'font-semibold text-gray-900';
    title.textContent = point.name;
    const dist = document.createElement('p');
    dist.className = 'text-sm text-gray-600';
    dist.textContent = point.distance;
    textWrap.appendChild(title);
    textWrap.appendChild(dist);

    left.appendChild(pinWrap);
    left.appendChild(textWrap);

    const toggle = document.createElement('button');
    toggle.className = 'relative inline-flex h-6 w-11 items-center rounded-full transition-colors ' +
      (point.active ? 'bg-blue-600' : 'bg-gray-300');
    toggle.setAttribute('data-id', point.id);
    toggle.addEventListener('click', () => toggleReminderPoint(point.id));

    const knob = document.createElement('span');
    knob.className = 'switch-knob inline-block h-4 w-4 transform rounded-full bg-white ' +
      (point.active ? 'translate-x-[1.25rem]' : 'translate-x-[0.25rem]');
    knob.style.transform = point.active ? 'translateX(1.25rem)' : 'translateX(0.25rem)';
    toggle.appendChild(knob);

    inner.appendChild(left);
    inner.appendChild(toggle);

    const metaGrid = document.createElement('div');
    metaGrid.className = 'grid grid-cols-2 gap-2 text-xs text-gray-500';
    const latDiv = document.createElement('div');
    latDiv.textContent = 'Lat: ' + point.lat.toFixed(4);
    const lngDiv = document.createElement('div');
    lngDiv.textContent = 'Lng: ' + point.lng.toFixed(4);
    metaGrid.appendChild(latDiv);
    metaGrid.appendChild(lngDiv);

    wrapper.appendChild(inner);
    wrapper.appendChild(metaGrid);
    reminderPointsGrid.appendChild(wrapper);
  });
}

/* --------------------------
   Actions
   -------------------------- */
function toggleGPS() {
  isGPSActive = !isGPSActive;
  renderGPSStatus();
}

function toggleReminderPoint(id) {
  reminderPoints = reminderPoints.map(p =>
    p.id === id ? {...p, active: !p.active} : p
  );
  renderReminderPoints();
}

function addReminderPoint() {
  const nextIndex = reminderPoints.length + 1;
  const newPoint = {
    id: Date.now(),
    name: `Reminder Point ${nextIndex}`,
    lat: destination.lat - 0.1 * nextIndex,
    lng: destination.lng + 0.1 * nextIndex,
    distance: `${nextIndex * 15} miles before destination`,
    active: true,
  };
  reminderPoints = [...reminderPoints, newPoint];
  renderReminderPoints();
}

function showAlarmBanner() {
  alarmBanner.classList.remove('hidden');
  if (alarmTimeout) clearTimeout(alarmTimeout);
  alarmTimeout = setTimeout(hideAlarmBanner, 5000);
}

function hideAlarmBanner() {
  alarmBanner.classList.add('hidden');
  if (alarmTimeout) {
    clearTimeout(alarmTimeout);
    alarmTimeout = null;
  }
}

/* --------------------------
   Event Listeners
   -------------------------- */
gpsToggleBtn.addEventListener('click', toggleGPS);
demoGpsToggleBtn.addEventListener('click', toggleGPS);
addPointBtn.addEventListener('click', addReminderPoint);
triggerAlarmBtn.addEventListener('click', showAlarmBanner);
alarmDismissBtn.addEventListener('click', hideAlarmBanner);

/* --------------------------
   Initial Render
   -------------------------- */
renderGPSStatus();
renderSpeed();
renderETA();
renderReminderPoints();

/* Optional: periodically refresh ETA text (every min) */
setInterval(renderETA, 60 * 1000);
</script>
</body>
</html>